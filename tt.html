<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        textarea { width: 100%; height: 200px; }
        button { margin-top: 10px; }tt
    </style>
</head>
<body>
    <h1>Book to Audio Converter</h1>
    <p>Upload a text file or paste book text below, select a voice, and click "Speak" to hear it. For large books, process in sections.</p>
    
    <input type="file" id="fileInput" accept=".txt">
    <button onclick="loadFile()">Load File</button>
    
    <textarea id="textInput" placeholder="Paste your book text here..."></textarea>
    
    <select id="voiceSelect"></select>
    <button onclick="speakText()">Speak</button>
    <button onclick="stopSpeaking()">Stop</button>

    <script>
        const synth = window.speechSynthesis;
        const textInput = document.getElementById('textInput');
        const voiceSelect = document.getElementById('voiceSelect');
        let voices = [];

        function populateVoices() {
            voices = synth.getVoices();
            voiceSelect.innerHTML = '';
            voices.forEach(voice => {
                const option = document.createElement('option');
                option.textContent = `${voice.name} (${voice.lang})`;
                option.value = voice.name;
                voiceSelect.appendChild(option);
            });
        }

        // Populate voices (may need to wait for them to load)
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoices;
        }
        populateVoices(); // Initial call

        function loadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    textInput.value = e.target.result;
                };
                reader.readAsText(file);
            }
        }

        function speakText() {
            if (synth.speaking) {
                console.error('Already speaking...');
                return;
            }
            const utterThis = new SpeechSynthesisUtterance(textInput.value);
            const selectedVoice = voiceSelect.value;
            const voice = voices.find(v => v.name === selectedVoice);
            if (voice) utterThis.voice = voice;
            utterThis.onend = () => console.log('Speech finished');
            synth.speak(utterThis);
        }

        function stopSpeaking() {
            synth.cancel();
        }
    </script>
</body>
</html>
